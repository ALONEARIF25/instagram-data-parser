<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Instagram Message Counter</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=WDXL+Lubrifont+SC&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Poppins", sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h3>Instagram-data-parser by alonearif</h3>

      <div class="file-input-container">
        <div
          class="file-input-section json-input-section"
          id="jsonInputSection"
        >
          <h3>ğŸ“„ Select Instagram Message JSON Files</h3>
          <p>Choose multiple message_*.json files to count total messages</p>
          <input
            type="file"
            id="fileInput"
            class="file-input"
            multiple
            accept=".json"
          />
          <div class="drag-drop-hint">
            ğŸ“ Drop JSON files here or click to browse
          </div>
        </div>

        <div
          class="file-input-section media-input-section"
          id="mediaInputSection"
        >
          <h3>ğŸ¬ Select Media Folder (Optional)</h3>
          <p>Upload the photos/videos/audio folder to view media in messages</p>
          <input
            type="file"
            id="mediaFolderInput"
            class="file-input"
            webkitdirectory
            directory
            multiple
          />
          <div class="drag-drop-hint">
            ğŸ“‚ Drop media folder here or click to browse
          </div>
        </div>
      </div>

      <div class="process-section">
        <button onclick="processFiles()" id="processBtn" class="process-btn">
          Process Files
        </button>

        <div class="progress" id="progressContainer">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <p id="progressText">Processing files...</p>
        </div>
      </div>

      <div class="search-section" id="searchSection" style="display: none">
        <h3>ğŸ” Search Messages</h3>
        <div class="search-input-container">
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="Enter word or phrase to search..."
          />
          <button onclick="searchMessages()" id="searchBtn" class="search-btn">
            Search
          </button>
        </div>
        <div id="searchResults" class="search-results"></div>
      </div>

      <div class="top-words-section" id="topWordsSection" style="display: none">
        <h3>Top 50 Most Used Words</h3>
        <div id="topWordsList" class="top-words-list"></div>
      </div>

      <div class="heatmap-section" id="heatmapSection" style="display: none">
        <h3>Activity Heatmap</h3>
        <p class="heatmap-subtitle">Daily message activity over time</p>
        <div id="heatmapContainer" class="heatmap-container"></div>
        <div class="heatmap-legend">
          <span class="legend-label">Less</span>
          <div class="legend-box level-0"></div>
          <div class="legend-box level-1"></div>
          <div class="legend-box level-2"></div>
          <div class="legend-box level-3"></div>
          <div class="legend-box level-4"></div>
          <span class="legend-label">More</span>
        </div>
      </div>

      <div
        class="lowest-date-messages-section"
        id="lowestDateMessagesSection"
        style="display: none"
      >
        <h3>ğŸ“‰ Messages from Lowest Activity Day</h3>
        <div class="lowest-date-info" id="lowestDateInfo"></div>
        <div class="lowest-date-messages" id="lowestDateMessages"></div>
        <div class="resize-handle" id="lowestDateResizeHandle">
          <div class="resize-icon">â‹®</div>
          <span class="resize-text">Drag to resize</span>
        </div>
      </div>

      <div
        class="date-picker-section"
        id="datePickerSection"
        style="display: none"
      >
        <h3>ğŸ“… View Messages by Date</h3>
        <div class="date-picker-container">
          <input type="date" id="datePicker" class="date-input" />
          <button
            onclick="viewMessagesByDate()"
            id="viewDateBtn"
            class="view-date-btn"
          >
            View Messages
          </button>
        </div>
        <div class="selected-date-info" id="selectedDateInfo"></div>
        <div class="selected-date-messages" id="selectedDateMessages"></div>
        <div class="resize-handle" id="selectedDateResizeHandle">
          <div class="resize-icon">â‹®</div>
          <span class="resize-text">Drag to resize</span>
        </div>
      </div>

      <div class="results" id="results" style="display: none">
        <h3>Results</h3>
        <div id="fileResults"></div>

        <div class="stats" id="statsContainer" style="display: none">
          <div class="stat-card">
            <div class="stat-number" id="totalMessages">0</div>
            <div class="stat-label">Total Messages</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="participantCount">0</div>
            <div class="stat-label">Participants</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="dateRange">-</div>
            <div class="stat-label">Conversation Span</div>
          </div>

          <div class="stat-card">
            <div class="stat-number" id="imagesCount">0</div>
            <div class="stat-label">
              ğŸ“· Images<br /><span id="imagesPercent">0%</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="audioCount">0</div>
            <div class="stat-label">
              ğŸ™ï¸ Voice Messages<br /><span id="audioPercent">0%</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="videosCount">0</div>
            <div class="stat-label">
              ğŸ¥ Videos<br /><span id="videosPercent">0%</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="highestDailyChat">0</div>
            <div class="stat-label">
              Highest Daily<br /><span id="highestDailyDate">-</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="lowestDailyChat">0</div>
            <div class="stat-label">
              Lowest Daily<br /><span id="lowestDailyDate">-</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="avgDailyChat">0</div>
            <div class="stat-label">Avg Daily Chat</div>
          </div>
        </div>

        <div id="participantStats"></div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
